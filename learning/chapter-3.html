<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162942761-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-162942761-1');
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Statistical Rethinking Chapter 3 Exercises" />
<meta property="og:description" content="Statistical Rethinking Chapter 3" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ericpena.github.io/learning/chapter-3.html" /><meta property="article:section" content="learning" />
<meta property="article:published_time" content="2022-04-23T00:00:00-07:00" />
<meta property="article:modified_time" content="2022-04-23T00:00:00-07:00" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Statistical Rethinking Chapter 3 Exercises"/>
<meta name="twitter:description" content="Statistical Rethinking Chapter 3"/>


<meta name="generator" content="Hugo 0.101.0" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Statistical Rethinking Chapter 3 Exercises",
  "url": "https:\/\/ericpena.github.io\/learning\/chapter-3.html",
  "wordCount": "568",
  "datePublished": "2022-04-23T00:00:00-07:00",
  "dateModified": "2022-04-23T00:00:00-07:00",
  "author": {
    "@type": "Person",
    "name": "Eric Peña"
  },
  "description": "Statistical Rethinking Chapter 3"
}
</script>



    <title>Statistical Rethinking Chapter 3 Exercises</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://ericpena.github.io/css/custom.css" rel="stylesheet">
    <link href="https://ericpena.github.io/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">

    

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container">
            <a class="navbar-brand" href="https://ericpena.github.io/about/eric_pena.html">Eric Peña</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="navbar-nav">

                    <li class="nav-item">
                        <a class="nav-link" href="https://ericpena.github.io">PEÑA NOTES</a>
                    </li>

                    

                    

                    

                    <li class="nav-item">
                        <a class="nav-link" href="https://ericpena.github.io/about/eric_pena.html">About Me</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            CONNECT
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://www.linkedin.com/in/eric-pena/" target="_blank">LinkedIn</a>
                            <a class="dropdown-item" href="https://twitter.com/ericpenax" target="_blank">X</a>
                            
                            <a class="dropdown-item" href="https://github.com/ericpena" target="_blank">GitHub</a>
                            <a class="dropdown-item" href="mailto:pena.eng.physics@gmail.com" target="_blank">Email</a>
                            
                            
                            
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                


<article>
  <div class="non-technical_note">
    <header>
      <h1 class="non-technical_note_title">Statistical Rethinking Chapter 3 Exercises</h1>
      <div class="non-technical_note_date">
        <time datetime=" 2022-04-23T00:00:00-07:00 "> 23 April 2022</time>
      </div>
    </header>
    <div class="content">
    <pre tabindex="0"><code class="language-{r" data-lang="{r">knitr::opts_chunk$set(echo = TRUE)
library(rethinking)
</code></pre><h2 id="preliminary-code">Preliminary Code</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p_grid</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">length.out</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prior</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">likelihood</span> <span class="o">&lt;-</span> <span class="nf">dbinom</span><span class="p">(</span><span class="m">6</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">9</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">p_grid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">posterior</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">posterior</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="3e1">3E1.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">samples</span> <span class="o">&lt;</span> <span class="m">0.2</span><span class="p">)</span> <span class="o">/</span> <span class="nf">length</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>## [1] 5e-04
</code></pre>
<h2 id="3e2">3E2.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">samples</span> <span class="o">&gt;</span> <span class="m">0.8</span><span class="p">)</span> <span class="o">/</span> <span class="nf">length</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>## [1] 0.1181
</code></pre>
<h2 id="3e4">3E4.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">quantile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="m">0.2</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>##       20% 
## 0.5155155
</code></pre>
<h2 id="3e5">3E5.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">quantile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="m">0.8</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>##       80% 
## 0.7597598
</code></pre>
<h2 id="3e6">3E6.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">HPDI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.66</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>##     |0.66     0.66| 
## 0.5095095 0.7807808
</code></pre>
<h2 id="3e7">3E7.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">PI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.66</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>##       17%       83% 
## 0.4984985 0.7737738
</code></pre>
<h2 id="3m1">3M1.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p_grid</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">length.out</span><span class="o">=</span><span class="m">1e3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prior</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">p_grid</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">likelihood</span> <span class="o">&lt;-</span> <span class="nf">dbinom</span><span class="p">(</span><span class="m">8</span><span class="p">,</span> <span class="m">15</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">p_grid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">posterior</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-1.png" alt="png"></p>
<h2 id="3m2">3M2.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">HPDI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.90</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>##      |0.9      0.9| 
## 0.3343343 0.7177177
</code></pre>
<h2 id="3m3">3M3.</h2>
<p>Construct a posterior predictive check</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="m">8</span><span class="p">)</span> <span class="o">/</span> <span class="m">1e4</span>
</span></span></code></pre></div><pre><code>## [1] 0.1471
</code></pre>
<h2 id="3m4">3M4.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">9</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">w</span><span class="o">==</span><span class="m">6</span><span class="p">)</span> <span class="o">/</span> <span class="m">1e4</span>
</span></span></code></pre></div><pre><code>## [1] 0.1732
</code></pre>
<h2 id="3m5">3M5.</h2>
<h4 id="redo-3m1">Redo 3M1.</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p_grid</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">length.out</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prior</span> <span class="o">&lt;-</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">p_grid</span> <span class="o">&lt;</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">likelihood</span> <span class="o">&lt;-</span> <span class="nf">dbinom</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">p_grid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">posterior</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;l&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-2.png" alt="png"></p>
<h4 id="redo-3m2">Redo 3M2.</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">HPDI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.9</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>##      |0.9      0.9| 
## 0.5005005 0.7117117
</code></pre>
<h4 id="redo-3m3">Redo 3M3.</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">15</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="m">8</span><span class="p">)</span> <span class="o">/</span> <span class="m">1e4</span>
</span></span></code></pre></div><pre><code>## [1] 0.1522
</code></pre>
<h4 id="redo-3m4">Redo 3M4.</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">9</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="m">6</span><span class="p">)</span> <span class="o">/</span> <span class="m">1e4</span>
</span></span></code></pre></div><pre><code>## [1] 0.2337
</code></pre>
<h2 id="3m6">3M6.</h2>
<p>You want the 99% percentile interval of the posterior distribution of
<em>p</em> to be only 0.05 wide. This means the distance between the upper and
lower bound of the interval should be 0.05. How many times will you have
to toss the globe to do this?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">real_water</span> <span class="o">&lt;-</span> <span class="m">0.7</span>
</span></span><span class="line"><span class="cl"><span class="n">p_grid</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">length.out</span><span class="o">=</span><span class="m">1e4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prior</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">p_grid</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">posteriors</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">likelihood</span> <span class="o">&lt;-</span> <span class="nf">dbinom</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">real_water</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">p_grid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
</span></span><span class="line"><span class="cl">  <span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">posterior</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">return</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">3000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">posterior</span> <span class="o">=</span> <span class="nf">posteriors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">interval</span> <span class="o">&lt;-</span> <span class="nf">PI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.99</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">diff</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">interval[2]</span> <span class="o">-</span> <span class="n">interval[1]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="n">diff</span> <span class="o">&lt;=</span> <span class="m">0.05</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">break</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><pre><code>## [1] 2133
</code></pre>
<h1 id="hard-problems">Hard Problems</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">data</span><span class="p">(</span><span class="n">homeworkch3</span><span class="p">)</span>
</span></span></code></pre></div><h1 id="3h1">3H1.</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p_grid</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">length.out</span><span class="o">=</span><span class="m">1e3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">prior</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">p_grid</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">likelihood</span> <span class="o">&lt;-</span> <span class="nf">dbinom</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">sum</span><span class="p">(</span><span class="n">birth2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">birth1</span><span class="p">)</span><span class="o">+</span><span class="nf">length</span><span class="p">(</span><span class="n">birth2</span><span class="p">),</span> <span class="n">prob</span><span class="o">=</span><span class="n">p_grid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
</span></span><span class="line"><span class="cl"><span class="n">posterior</span> <span class="o">&lt;-</span> <span class="n">posterior</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">max_p</span> <span class="o">=</span> <span class="n">p_grid</span><span class="nf">[which.max</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">max_p</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>## [1] 0.5545546
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s">&#34;l&#34;</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&#34;posterior of overall male birth rate&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">max_p</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-3.png" alt="png"></p>
<h2 id="3h2">3H2.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-4.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="nf">HPDI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>##      |0.5      0.5| 
## 0.5305305 0.5765766
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="nf">HPDI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.89</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>##     |0.89     0.89| 
## 0.4994995 0.6096096
</code></pre>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="nf">HPDI</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="m">0.97</span><span class="p">))</span>
</span></span></code></pre></div><pre><code>##     |0.97     0.97| 
## 0.4774775 0.6266266
</code></pre>
<h2 id="3h3">3H3.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bsimulation</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">200</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">bsimulation</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&#34;Posterior Predictive&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span> <span class="n">v</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth1</span><span class="p">)</span><span class="o">+</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth2</span><span class="p">)</span> <span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span> <span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-5.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p.samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10000</span> <span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span> <span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bsim</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="m">10000</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">200</span> <span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># adj value makes a strict histogram, with spikes at integers</span>
</span></span><span class="line"><span class="cl"><span class="nf">dens</span><span class="p">(</span> <span class="n">bsim</span> <span class="p">,</span> <span class="n">adj</span><span class="o">=</span><span class="m">0.1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span> <span class="n">v</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth1</span><span class="p">)</span><span class="o">+</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth2</span><span class="p">)</span> <span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span> <span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-6.png" alt="png"></p>
<h2 id="3h4">3H4.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">posterior</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bsim</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">100</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dens</span><span class="p">(</span> <span class="n">bsim</span> <span class="p">,</span> <span class="n">adj</span><span class="o">=</span><span class="m">0.1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span> <span class="n">v</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth1</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span> <span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-7.png" alt="png"></p>
<h2 id="3h5">3H5.</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">female.first.borns</span> <span class="o">&lt;-</span> <span class="nf">length</span><span class="p">(</span><span class="nf">which</span><span class="p">(</span><span class="n">birth1</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">bsim</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="m">1e4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">female.first.borns</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dens</span><span class="p">(</span><span class="n">bsim</span><span class="p">,</span> <span class="n">adj</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">birth2</span><span class="nf">[which</span><span class="p">(</span><span class="n">birth1</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span><span class="n">]</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="chapter-3/ch3-8.png" alt="png">
The actual number of boys after girls is higher than predicted (with
assuming independence). This means that gender birth may not be
independent after all.</p>

  </div>
  
      </div>
      
  </article>



            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">Copyright &copy; Eric Peña, <time datetime="2024">2024</time>. All 30 notes and articles are available on <a href="https://github.com/ericpena/">GitHub</a>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>